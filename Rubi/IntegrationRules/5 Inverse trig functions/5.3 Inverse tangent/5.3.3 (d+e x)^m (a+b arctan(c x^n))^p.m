
(* ::Subsection::Closed:: *)
(* 5.3.3 (d+e x)^m (a+b arctan(c x^n))^p *)
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])^p*Log[2/(1 + e*x/d)]/e + b*c*p/e* Int[(a + b*ArcTan[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])^p*Log[2/(1 + e*x/d)]/e - b*c*p/e* Int[(a + b*ArcCot[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])*Log[2/(1 - I*c*x)]/e + b*c/e*Int[Log[2/(1 - I*c*x)]/(1 + c^2*x^2), x] + (a + b*ArcTan[c*x])* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e - b*c/e* Int[Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])*Log[2/(1 - I*c*x)]/e - b*c/e*Int[Log[2/(1 - I*c*x)]/(1 + c^2*x^2), x] + (a + b*ArcCot[c*x])* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + b*c/e* Int[Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])^2*Log[2/(1 - I*c*x)]/e + I*b*(a + b*ArcTan[c*x])*PolyLog[2, 1 - 2/(1 - I*c*x)]/e - b^2*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) + (a + b*ArcTan[c*x])^2* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e - I*b*(a + b*ArcTan[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + b^2* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])^2*Log[2/(1 - I*c*x)]/e - I*b*(a + b*ArcCot[c*x])*PolyLog[2, 1 - 2/(1 - I*c*x)]/e - b^2*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) + (a + b*ArcCot[c*x])^2* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + I*b*(a + b*ArcCot[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + b^2* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])^3*Log[2/(1 - I*c*x)]/e + 3*I*b*(a + b*ArcTan[c*x])^2*PolyLog[2, 1 - 2/(1 - I*c*x)]/(2*e) - 3*b^2*(a + b*ArcTan[c*x])*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) - 3*I*b^3*PolyLog[4, 1 - 2/(1 - I*c*x)]/(4*e) + (a + b*ArcTan[c*x])^3* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e - 3*I*b*(a + b*ArcTan[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) + 3*b^2*(a + b*ArcTan[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) + 3*I*b^3* PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])^3*Log[2/(1 - I*c*x)]/e - 3*I*b*(a + b*ArcCot[c*x])^2*PolyLog[2, 1 - 2/(1 - I*c*x)]/(2*e) - 3*b^2*(a + b*ArcCot[c*x])*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) + 3*I*b^3*PolyLog[4, 1 - 2/(1 - I*c*x)]/(4*e) + (a + b*ArcCot[c*x])^3* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + 3*I*b*(a + b*ArcCot[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) + 3*b^2*(a + b*ArcCot[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) - 3*I*b^3* PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTan[c*x])/(e*(q + 1)) - b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCot[c*x])/(e*(q + 1)) + b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTan[c*x])^p/(e*(q + 1)) - b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcTan[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 + c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCot[c*x])^p/(e*(q + 1)) + b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcCot[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 + c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*ArcTan[c*x^n])/e - b*c*n/e*Int[x^(n - 1)*Log[d + e*x]/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[n]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*ArcCot[c*x^n])/e + b*c*n/e*Int[x^(n - 1)*Log[d + e*x]/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[n]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcTan[c*x^(k*n)])/(d + e*x^k), x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[n]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcCot[c*x^(k*n)])/(d + e*x^k), x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[n]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcTan[c*x^n])/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[x^(n - 1)*(d + e*x)^(m + 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCot[c*x^n])/(e*(m + 1)) + b*c*n/(e*(m + 1))* Int[x^(n - 1)*(d + e*x)^(m + 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTan[c*x^n])^p, (d + e*x)^m, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 1] && IGtQ[m, 0]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCot[c*x^n])^p, (d + e*x)^m, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 1] && IGtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[(d + e*x)^m*(a + b*ArcTan[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[(d + e*x)^m*(a + b*ArcCot[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
