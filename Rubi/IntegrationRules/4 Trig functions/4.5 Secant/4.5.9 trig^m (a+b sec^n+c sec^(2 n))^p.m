
(* ::Subsection::Closed:: *)
(* 4.5.9 trig^m (a+b sec^n+c sec^(2 n))^p *)
Int[(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Sec[d + e*x]^n + c*Sec[d + e*x]^(2*n))^ p/(b + 2*c*Sec[d + e*x]^n)^(2*p)* Int[u*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Csc[d + e*x]^n + c*Csc[d + e*x]^(2*n))^ p/(b + 2*c*Csc[d + e*x]^n)^(2*p)* Int[u*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[1/(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Sec[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Sec[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Csc[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Csc[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cos[d + e*x], x]}, -f/e* Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*(b + a*(f*x)^n)^p/(f*x)^(n*p), x], x, Cos[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegersQ[n, p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Sin[d + e*x], x]}, f/e* Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*(b + a*(f*x)^n)^p/(f*x)^(n*p), x], x, Sin[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegersQ[n, p]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*sec[d_. + e_.*x_]^n_ + c_.*sec[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*csc[d_. + e_.*x_]^n_ + c_.*csc[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sec[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Sec[d + e*x]^m*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[csc[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Csc[d + e*x]^m*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sec[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Sec[d + e*x]^n + c*Sec[d + e*x]^(2*n))^ p/(b + 2*c*Sec[d + e*x]^n)^(2*p)* Int[Sec[d + e*x]^m*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[csc[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Csc[d + e*x]^n + c*Csc[d + e*x]^(2*n))^ p/(b + 2*c*Csc[d + e*x]^n)^(2*p)* Int[Csc[d + e*x]^m*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[sec[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := Int[ExpandTrig[ sec[d + e*x]^m*(a + b*sec[d + e*x]^n + c*sec[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegersQ[m, n, p]
Int[csc[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := Int[ExpandTrig[ csc[d + e*x]^m*(a + b*csc[d + e*x]^n + c*csc[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegersQ[m, n, p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Cos[d + e*x], x]}, -1/(e*f^(m + n*p - 1))* Subst[Int[(1 - f^2*x^2)^((m - 1)/ 2)*(c + b*(f*x)^n + c*(f*x)^(2*n))^p/x^(m + 2*n*p), x], x, Cos[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*csc[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Sin[d + e*x], x]}, 1/(e*f^(m + n*p - 1))* Subst[Int[(1 - f^2*x^2)^((m - 1)/ 2)*(c + b*(f*x)^n + c*(f*x)^(2*n))^p/x^(m + 2*n*p), x], x, Sin[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*sec[d_. + e_.*x_]^n_ + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*csc[d_. + e_.*x_]^n_ + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[(A_ + B_.*sec[d_. + e_.*x_])*(a_ + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Sec[d + e*x])*(b + 2*c*Sec[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*csc[d_. + e_.*x_])*(a_ + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Csc[d + e*x])*(b + 2*c*Csc[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*sec[d_. + e_.*x_])*(a_ + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Sec[d + e*x] + c*Sec[d + e*x]^2)^ n/(b + 2*c*Sec[d + e*x])^(2*n)* Int[(A + B*Sec[d + e*x])*(b + 2*c*Sec[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*csc[d_. + e_.*x_])*(a_ + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Csc[d + e*x] + c*Csc[d + e*x]^2)^ n/(b + 2*c*Csc[d + e*x])^(2*n)* Int[(A + B*Csc[d + e*x])*(b + 2*c*Csc[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*sec[d_. + e_.*x_])/(a_. + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Sec[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Sec[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*csc[d_. + e_.*x_])/(a_. + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Csc[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Csc[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*sec[d_. + e_.*x_])*(a_. + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*sec[d + e*x])*(a + b*sec[d + e*x] + c*sec[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*csc[d_. + e_.*x_])*(a_. + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*csc[d + e*x])*(a + b*csc[d + e*x] + c*csc[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
